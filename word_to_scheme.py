from utils.utils import get_word_scheme, vis_image_scheme, load_dictionary, validate_and_process_word
import random
import os

# –°–ø–∏—Å–æ–∫ –∑–∞–±–∞–≤–Ω—ã—Ö –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π
funny_prompts = [
    "üéØ –í–≤–µ–¥–∏ —Å–ª–æ–≤–æ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ (–¥–ª—è –≤—ã—Ö–æ–¥–∞ –≤–≤–µ–¥–∏ Q –∏–ª–∏ –ô) ",
    "üîç –ö–∞–∫–æ–µ —Å–ª–æ–≤–æ —Ä–∞–∑–±–µ—Ä–µ–º –Ω–∞ –∑–∞–ø—á–∞—Å—Ç–∏? (Q/–ô –¥–ª—è –≤—ã—Ö–æ–¥–∞) ",
    "üîÆ –í–∏–∂—É, —É —Ç–µ–±—è –µ—Å—Ç—å —Å–ª–æ–≤–æ –¥–ª—è –º–µ–Ω—è... –í–≤–æ–¥–∏! (Q/–ô - –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å —è—Å–Ω–æ–≤–∏–¥–µ–Ω–∏–µ) ",
]

def process_and_save_word(word):
    """
    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª–æ–≤–æ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º
    """
    print(f"üîÑ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é —Å–ª–æ–≤–æ '{word}'...")
    
    # –°–æ–∑–¥–∞–µ–º —Å—Ö–µ–º—É —Å–ª–æ–≤–∞
    img = get_word_scheme(word.upper())
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏ –ø–æ–ª—É—á–∞–µ–º –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
    result_path = vis_image_scheme(word=word, image=img)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ñ–∞–π–ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è
    if result_path and os.path.exists(result_path):
        file_size = os.path.getsize(result_path)
        save_messages = [
            f"üíæ –°–ª–æ–≤–æ '{word}' —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ! –§–∞–π–ª: {result_path}",
            f"‚úÖ –ì–æ—Ç–æ–≤–æ! –°—Ö–µ–º–∞ —Å–ª–æ–≤–∞ '{word}' –∑–∞–ø–∏—Å–∞–Ω–∞ –≤ {result_path}",
            f"üéâ –£—Ä–∞! –°–ª–æ–≤–æ '{word}' —Ä–∞–∑–æ–±—Ä–∞–Ω–æ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –∫–∞–∫ {result_path}",
            f"üìÅ –°—Ö–µ–º–∞ —Å–ª–æ–≤–∞ '{word}' —Ç–µ–ø–µ—Ä—å –∂–∏–≤–µ—Ç –≤ {result_path}",
            f"üîñ –ó–∞–ø–æ–º–Ω–∏: —Å—Ö–µ–º–∞ —Å–ª–æ–≤–∞ '{word}' –∂–¥–µ—Ç —Ç–µ–±—è –≤ {result_path}",
            f"üè∑Ô∏è –°–ª–æ–≤–æ '{word}' –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–æ! –ú–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è: {result_path}",
            f"üìã –ú–∏—Å—Å–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞! –°—Ö–µ–º–∞ —Å–ª–æ–≤–∞ '{word}' –≤ {result_path}",
            f"üéä –§–∞–π–ª —Å–æ —Å—Ö–µ–º–æ–π —Å–ª–æ–≤–∞ '{word}' —Å–æ–∑–¥–∞–Ω! –ü—É—Ç—å: {result_path}"
        ]
        
        print(f"‚úÖ {random.choice(save_messages)}")
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–±–∞–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        fun_facts = [
            "üê± –ö—Å—Ç–∞—Ç–∏, —ç—Ç–æ —Å–ª–æ–≤–æ –º–æ–∂–Ω–æ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ—Ç–∏–∫—É!",
            "üåü –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –¢–≤–æ–µ —Å–ª–æ–≤–æ —Ç–µ–ø–µ—Ä—å –≤ –∏—Å—Ç–æ—Ä–∏–∏!",
            "üç™ –¢–∞–∫–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Å—Ç–æ–∏—Ç –ø–µ—á–µ–Ω—å–∫–∏!",
            "üìö –ö–æ–ª–ª–µ–∫—Ü–∏—è —Å—Ö–µ–º —Å–ª–æ–≤ –ø–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è!",
            "ü§ì –¢–µ–ø–µ—Ä—å —Ç—ã –∑–Ω–∞–µ—à—å —ç—Ç–æ —Å–ª–æ–≤–æ –ª—É—á—à–µ –¥—Ä—É–≥–∏—Ö!",
        ]
        print(f"üí° {random.choice(fun_facts)}")
        
    else:
        print(f"‚ùå –£–ø—Å! –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ö–µ–º—É —Å–ª–æ–≤–∞ '{word}'. –ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑!")
    
    return result_path

dictionary = load_dictionary("/workspaces/word-scheme/russian-words/russian.txt")
if not dictionary:
    print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ª–æ–≤–∞—Ä—å. –ë—É–¥—É –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å–ª–æ–≤–∞ –ø–æ –ø–∞–º—è—Ç–∏... –∞ –æ–Ω–∞ —É –º–µ–Ω—è, –∫–∞–∫ —É –∑–æ–ª–æ—Ç–æ–π —Ä—ã–±–∫–∏!")

# –°—á–µ—Ç—á–∏–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å–ª–æ–≤
word_count = 0

while True:
    # –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –∑–∞–±–∞–≤–Ω–æ–≥–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
    word = input(f"\n{random.choice(funny_prompts)}")
    
    result = validate_and_process_word(word, dictionary)
    
    if result == "exit":
        print(f"üëã –ü–æ–∫–∞-–ø–æ–∫–∞! –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Å–ª–æ–≤: {word_count}. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å –Ω–æ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏!")
        break
    elif result == "not_in_dict":
        print(f"ü§î –°–ª–æ–≤–æ '{word}' –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ —Å–ª–æ–≤–∞—Ä–µ. –í–æ–∑–º–æ–∂–Ω–æ –æ–Ω–æ –≤–≤–µ–¥–µ–Ω–æ —Å –æ—à–∏–±–∫–æ–π, –∞ –≤–æ–∑–º–æ–∂–Ω–æ, —Ç—ã –∏–∑–æ–±—Ä–µ–ª –Ω–æ–≤–æ–µ —Å–ª–æ–≤–æ!")
        choice = input("üí° –í–≤–µ–¥–∏—Ç–µ 1 –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Å —ç—Ç–∏–º —Å–ª–æ–≤–æ–º (–Ω–∞ —Å–≤–æ–π —Å—Ç—Ä–∞—Ö –∏ —Ä–∏—Å–∫!) –∏–ª–∏ –Ω–æ–≤–æ–µ —Å–ª–æ–≤–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏: ")
        
        if choice == '1':
            print("üöÄ –ó–∞–ø—É—Å–∫–∞—é –æ–±—Ä–∞–±–æ—Ç–∫—É! –ù–∞–¥–µ—é—Å—å, —Ç–≤–æ–µ —Å–ª–æ–≤–æ –Ω–µ –≤–∑–æ—Ä–≤–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É!")
            process_and_save_word(word)
            word_count += 1
        elif choice == word:
            print(f"üò≤ –û–ø—è—Ç—å '{choice}'? –¢—ã –Ω–∞—Å—Ç–æ–π—á–∏–≤! –¢–∞–∫ —É–∂ –∏ –±—ã—Ç—å! –ó–∞–ø—É—Å–∫–∞—é –æ–±—Ä–∞–±–æ—Ç–∫—É!üöÄ")
            process_and_save_word(word)
            word_count += 1
        elif choice in 'Qq–ô–π':
            print(f"üëã –ü–æ–∫–∞-–ø–æ–∫–∞! –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Å–ª–æ–≤: {word_count}. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å –Ω–æ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏!")
            break
        else:
            print(f"üîç –ü—Ä–æ–≤–µ—Ä—è—é –Ω–æ–≤–æ–µ —Å–ª–æ–≤–æ: '{choice}'")
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤–æ–µ —Å–ª–æ–≤–æ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
            word = choice
            new_result = validate_and_process_word(word, dictionary)
            
            if new_result == "exit":
                print(f"üëã –í—ã—Ö–æ–¥–∏–º! –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Å–ª–æ–≤: {word_count}. –î–æ –≤—Å—Ç—Ä–µ—á–∏!")
                break
            elif new_result == "not_in_dict":
                print("üòÖ –ò —ç—Ç–æ —Å–ª–æ–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ! –ú–æ–∂–µ—Ç, –ø–æ–ø—Ä–æ–±—É–µ–º —á—Ç–æ-—Ç–æ –∏–∑ –∫–ª–∞—Å—Å–∏–∫–∏? –ù–∞–ø—Ä–∏–º–µ—Ä, '–∫–æ—Ç–∏–∫' –∏–ª–∏ '–ø–µ—á–µ–Ω—å–∫–∞'?")
                continue
            else:
                # –°–ª–æ–≤–æ –ø—Ä–æ—à–ª–æ –ø—Ä–æ–≤–µ—Ä–∫—É
                process_and_save_word(word)
                word_count += 1
    elif result == "invalid":
        continue
    else:
        # –°–ª–æ–≤–æ –ø—Ä–æ—à–ª–æ –ø—Ä–æ–≤–µ—Ä–∫—É
        process_and_save_word(word)
        word_count += 1

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥—ã–µ 5 —Å–ª–æ–≤
    if word_count % 5 == 0:
        progress_messages = [
            f"üéä –ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –¢—ã –æ–±—Ä–∞–±–æ—Ç–∞–ª —É–∂–µ {word_count} —Å–ª–æ–≤!",
            f"üìà –û—Ç–ª–∏—á–Ω—ã–π —Ç–µ–º–ø! –£–∂–µ {word_count} —Å–ª–æ–≤ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏!",
            f"üåü –¶–µ–ª–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –∏–∑ {word_count} —Å–ª–æ–≤! –¢—ã –ø—Ä–æ—Å—Ç–æ —Å–ª–æ–≤–æ–∑–Ω–∞–π–∫–∞!",
            f"üèÜ {word_count} —Å–ª–æ–≤ —Ä–∞–∑–æ–±—Ä–∞–Ω–æ! –¢—ã –Ω–∞ –ø—É—Ç–∏ –∫ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤—É!",
            f"üìö –£–∂–µ {word_count} —Å–ª–æ–≤ –≤ —Ç–≤–æ–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ —Å—Ö–µ–º!"
        ]
        print(f"\nüéØ {random.choice(progress_messages)}")
